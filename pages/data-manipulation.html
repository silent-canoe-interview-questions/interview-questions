<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Manipulation - Learn Microsoft SQL Server</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css">
    <link rel="stylesheet" href="../styles/main.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container">
            <a class="navbar-brand" href="../index.html">SQL Tutorial</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="basics.html">Basics</a></li>
                    <li class="nav-item"><a class="nav-link active" href="data-manipulation.html">Data Manipulation</a></li>
                    <li class="nav-item"><a class="nav-link" href="advanced-topics.html">Advanced Topics</a></li>
                    <li class="nav-item"><a class="nav-link" href="examples.html">Examples</a></li>
                    <li class="nav-item"><a class="nav-link" href="best-practices.html">Best Practices</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container mt-5 pt-4">
        <h1 class="mb-4">Data Manipulation in SQL</h1>

        <section id="select" class="mb-5">
            <h2>SELECT Statement</h2>
            <p>The SELECT statement is used to retrieve data from one or more tables. It's the most commonly used SQL command.</p>

            <h3>Basic SELECT Syntax</h3>
            <pre><code class="language-sql">-- Basic SELECT syntax
SELECT column1, column2, ...
FROM table_name
WHERE condition
ORDER BY column1 [ASC|DESC];</code></pre>

            <h3>Common SELECT Operations</h3>
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Operation</th>
                            <th>Example</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Select All Columns</td>
                            <td><code>SELECT * FROM Employees;</code></td>
                            <td>Retrieves all columns from the Employees table</td>
                        </tr>
                        <tr>
                            <td>Select Specific Columns</td>
                            <td><code>SELECT FirstName, LastName FROM Employees;</code></td>
                            <td>Retrieves only specified columns</td>
                        </tr>
                        <tr>
                            <td>Distinct Values</td>
                            <td><code>SELECT DISTINCT Department FROM Employees;</code></td>
                            <td>Retrieves unique values only</td>
                        </tr>
                        <tr>
                            <td>Filtered Results</td>
                            <td><code>SELECT * FROM Employees WHERE Salary > 50000;</code></td>
                            <td>Retrieves rows matching the condition</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Advanced SELECT Features</h3>
            <pre><code class="language-sql">-- Using aggregate functions
SELECT 
    Department,
    COUNT(*) as EmployeeCount,
    AVG(Salary) as AverageSalary,
    MAX(Salary) as HighestSalary
FROM Employees
GROUP BY Department
HAVING COUNT(*) > 5
ORDER BY EmployeeCount DESC;</code></pre>
        </section>

        <section id="insert" class="mb-5">
            <h2>INSERT Operations</h2>
            <p>The INSERT statement is used to add new records to a table.</p>

            <h3>INSERT Syntax</h3>
            <pre><code class="language-sql">-- Single row insert
INSERT INTO Employees (FirstName, LastName, Email, Salary)
VALUES ('John', 'Doe', 'john.doe@example.com', 60000);

-- Multiple row insert
INSERT INTO Employees (FirstName, LastName, Email, Salary)
VALUES 
    ('Jane', 'Smith', 'jane.smith@example.com', 65000),
    ('Bob', 'Johnson', 'bob.johnson@example.com', 55000);</code></pre>

            <h3>INSERT with SELECT</h3>
            <pre><code class="language-sql">-- Insert data from another table
INSERT INTO EmployeeArchive (FirstName, LastName, Email, Salary)
SELECT FirstName, LastName, Email, Salary
FROM Employees
WHERE TerminationDate IS NOT NULL;</code></pre>
        </section>

        <section id="update" class="mb-5">
            <h2>UPDATE Operations</h2>
            <p>The UPDATE statement is used to modify existing records in a table.</p>

            <div class="alert alert-warning">
                <strong>Warning:</strong> Always use a WHERE clause with UPDATE statements to avoid updating all records unintentionally.
            </div>

            <h3>UPDATE Syntax</h3>
            <pre><code class="language-sql">-- Basic update
UPDATE Employees
SET Salary = 65000
WHERE EmployeeID = 1;

-- Multiple column update
UPDATE Employees
SET 
    Salary = Salary * 1.1,
    LastModified = GETDATE()
WHERE Department = 'Sales';</code></pre>

            <h3>UPDATE with JOIN</h3>
            <pre><code class="language-sql">-- Update using data from another table
UPDATE e
SET e.Salary = e.Salary * 1.1
FROM Employees e
INNER JOIN Departments d ON e.DepartmentID = d.DepartmentID
WHERE d.DepartmentName = 'IT';</code></pre>
        </section>

        <section id="delete" class="mb-5">
            <h2>DELETE Operations</h2>
            <p>The DELETE statement is used to remove records from a table.</p>

            <div class="alert alert-danger">
                <strong>Important:</strong> Always backup your data before performing DELETE operations, and always use a WHERE clause to avoid deleting all records.
            </div>

            <h3>DELETE Syntax</h3>
            <pre><code class="language-sql">-- Basic delete
DELETE FROM Employees
WHERE EmployeeID = 1;

-- Delete with subquery
DELETE FROM Employees
WHERE DepartmentID IN (
    SELECT DepartmentID 
    FROM Departments 
    WHERE DepartmentName = 'Archived'
);</code></pre>

            <h3>TRUNCATE vs DELETE</h3>
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Feature</th>
                            <th>DELETE</th>
                            <th>TRUNCATE</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>WHERE Clause</td>
                            <td>Supported</td>
                            <td>Not Supported</td>
                        </tr>
                        <tr>
                            <td>Transaction Log</td>
                            <td>Logged</td>
                            <td>Minimal Logging</td>
                        </tr>
                        <tr>
                            <td>Identity Reset</td>
                            <td>No</td>
                            <td>Yes</td>
                        </tr>
                        <tr>
                            <td>Triggers</td>
                            <td>Fired</td>
                            <td>Not Fired</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section id="practice" class="mb-5">
            <h2>Practice Exercises</h2>
            <div class="card">
                <div class="card-body">
                    <h3 class="card-title">Exercise 1: Employee Management</h3>
                    <p>Using the following table structure:</p>
                    <pre><code class="language-sql">CREATE TABLE Employees (
    EmployeeID INT PRIMARY KEY IDENTITY(1,1),
    FirstName NVARCHAR(50),
    LastName NVARCHAR(50),
    Email NVARCHAR(100),
    Department NVARCHAR(50),
    Salary DECIMAL(10,2)
);</code></pre>
                    
                    <p>Try these exercises:</p>
                    <ol>
                        <li>Insert three employees with different departments and salaries</li>
                        <li>Update the salary of all employees in the 'IT' department with a 10% raise</li>
                        <li>Delete any employee with a salary less than 30000</li>
                        <li>Select the average salary by department</li>
                    </ol>

                    <button class="btn btn-primary mt-3" data-bs-toggle="collapse" data-bs-target="#solution1">
                        Show Solution
                    </button>
                    
                    <div class="collapse mt-3" id="solution1">
                        <pre><code class="language-sql">-- 1. Insert employees
INSERT INTO Employees (FirstName, LastName, Email, Department, Salary)
VALUES 
    ('John', 'Doe', 'john.doe@example.com', 'IT', 60000),
    ('Jane', 'Smith', 'jane.smith@example.com', 'HR', 55000),
    ('Bob', 'Johnson', 'bob.johnson@example.com', 'IT', 65000);

-- 2. Update IT department salaries
UPDATE Employees
SET Salary = Salary * 1.1
WHERE Department = 'IT';

-- 3. Delete low-salary employees
DELETE FROM Employees
WHERE Salary < 30000;

-- 4. Average salary by department
SELECT 
    Department,
    AVG(Salary) as AverageSalary
FROM Employees
GROUP BY Department
ORDER BY AverageSalary DESC;</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <div class="navigation-buttons d-flex justify-content-between mt-5">
            <a href="basics.html" class="btn btn-secondary">&larr; Previous: Basics</a>
            <a href="advanced-topics.html" class="btn btn-primary">Next: Advanced Topics &rarr;</a>
        </div>
    </main>

    <footer class="bg-light mt-5 py-3">
        <div class="container text-center">
            <p>© 2025 SQL Tutorial. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-sql.min.js"></script>
    <script src="../scripts/main.js"></script>
</body>
</html>